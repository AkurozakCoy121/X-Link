<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NexeNews - Platform Berita Viral Indonesia</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/quill@2.0.0-rc.5/dist/quill.snow.css">
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/quill@2.0.0-rc.5/dist/quill.js"></script>
    
    <!-- FAVICON -->
    <link rel="icon" type="image/x-icon" href="https://cdn-icons-png.flaticon.com/512/841/841364.png">
    
    <!-- ADS SCRIPTS - PropellerAds -->
    <script>
        self.options = {
            domain: '3nbf4.com',
            zoneId: 10380831
        };
    </script>
    <script src="https://3nbf4.com/act/files/service-worker.min.js?r=sw"></script>
    <!-- Adsterra Popunder -->
    <script src="https://pl28354765.effectivegatecpm.com/4e/ae/a3/4eaea3d589b3192c4d7c30b94bad1c4e.js"></script>
    <!-- END ADS -->
    
    <style>
        * { margin:0; padding:0; box-sizing:border-box; }
        :root {
            --primary:#FF5722; --secondary:#FF9800; --accent:#FFC107; 
            --white:#fff; --dark:#333333; --gray:#757575; --light:#FFF8F0;
            --success:#4CAF50; --danger:#F44336; --warning:#FF9800; --info:#2196F3;
            --radius:12px; --radius-sm:6px; --radius-lg:16px;
            --shadow:0 4px 12px rgba(255, 87, 34, 0.1); 
            --shadow-lg:0 12px 32px rgba(0,0,0,0.12);
            --shadow-sm:0 2px 8px rgba(0,0,0,0.05);
            --transition:all 0.3s ease;
            --gradient-primary:linear-gradient(135deg, #FF5722 0%, #FF9800 100%);
            --gradient-warning:linear-gradient(135deg, #FF9800 0%, #FFC107 100%);
            --gradient-success:linear-gradient(135deg, #4CAF50 0%, #8BC34A 100%);
            --gradient-orange:linear-gradient(135deg, #FF5722 0%, #FF9800 100%);
            --gradient-light:linear-gradient(135deg, #FFF8F0 0%, #FFF3E0 100%);
            --sidebar-width:240px; --header-height:70px;
        }
        body { 
            font-family:'Poppins',sans-serif; 
            color:var(--dark); 
            background:#FFF8F0; 
            line-height:1.6; 
        }
        .container { max-width:1400px; margin:0 auto; padding:0 20px; }
        
        /* GLASS MORPHISM EFFECT */
        .glass-effect {
            background: rgba(255, 255, 255, 0.92);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: var(--shadow);
        }
        
        /* BUTTONS */
        .btn { 
            border:none; 
            border-radius:var(--radius); 
            padding:12px 24px; 
            font-weight:600; 
            cursor:pointer; 
            transition:var(--transition); 
            display:inline-flex; 
            align-items:center; 
            gap:8px; 
            font-size:0.95rem; 
            position:relative; 
            overflow:hidden; 
            font-family:'Poppins',sans-serif;
        }
        .btn-primary { 
            background:var(--gradient-primary); 
            color:var(--white); 
            box-shadow:0 4px 12px rgba(255, 87, 34, 0.25); 
        }
        .btn-primary:hover { 
            transform:translateY(-2px); 
            box-shadow:0 6px 20px rgba(255, 87, 34, 0.35); 
        }
        .btn-secondary { 
            background:transparent; 
            color:var(--primary); 
            border:2px solid var(--primary); 
        }
        .btn-secondary:hover { 
            background:var(--primary); 
            color:white; 
            transform:translateY(-2px); 
        }
        .btn-success { 
            background:var(--gradient-success); 
            color:white; 
            box-shadow:0 4px 12px rgba(76, 175, 80, 0.25); 
        }
        .btn-danger { 
            background:var(--gradient-warning); 
            color:white; 
            box-shadow:0 4px 12px rgba(255, 152, 0, 0.25); 
        }
        .btn-warning { 
            background:var(--gradient-warning); 
            color:var(--dark); 
            box-shadow:0 4px 12px rgba(255, 152, 0, 0.25); 
        }
        .btn-sm { padding:8px 16px; font-size:0.85rem; }
        .btn-lg { padding:14px 28px; font-size:1rem; }
        .btn-icon { width:40px; height:40px; padding:0; justify-content:center; border-radius:50%; }
        
        /* MODAL */
        .modal { 
            position:fixed; 
            top:0; left:0; 
            width:100%; 
            height:100%; 
            background:rgba(0,0,0,0.7); 
            display:none; 
            align-items:center; 
            justify-content:center; 
            z-index:2000; 
            backdrop-filter:blur(5px); 
        }
        .modal.active { 
            display:flex; 
            animation:modalBgFade 0.3s ease; 
        }
        @keyframes modalBgFade { 
            from { background:rgba(0,0,0,0); backdrop-filter:blur(0); } 
            to { background:rgba(0,0,0,0.7); backdrop-filter:blur(5px); } 
        }
        .modal-content { 
            background:white; 
            border-radius:var(--radius-lg); 
            max-width:90%; 
            max-height:90vh; 
            overflow-y:auto; 
            animation:modalSlideUp 0.4s ease; 
            box-shadow:0 20px 60px rgba(0,0,0,0.3); 
            border:none;
        }
        @keyframes modalSlideUp { 
            from { opacity:0; transform:translateY(40px) scale(0.95); } 
            to { opacity:1; transform:translateY(0) scale(1); } 
        }
        .modal-header { 
            padding:20px 25px; 
            border-bottom:1px solid #FFE0B2; 
            display:flex; 
            justify-content:space-between; 
            align-items:center; 
            background:var(--gradient-primary); 
            color:white; 
            border-radius:var(--radius-lg) var(--radius-lg) 0 0; 
        }
        .modal-close { 
            background:none; 
            border:none; 
            font-size:1.5rem; 
            cursor:pointer; 
            color:rgba(255,255,255,0.9); 
            transition:var(--transition); 
            width:36px; height:36px; 
            border-radius:50%; 
            display:flex; 
            align-items:center; 
            justify-content:center; 
        }
        .modal-close:hover { 
            background:rgba(255,255,255,0.2); 
            color:white; 
            transform:rotate(90deg); 
        }
        .modal-body { padding:25px; }
        
        /* NOTIFICATION */
        .notification { 
            position:fixed; 
            top:20px; 
            right:20px; 
            padding:15px 25px; 
            border-radius:var(--radius); 
            color:white; 
            z-index:3000; 
            display:none; 
            animation:slideInRight 0.3s ease; 
            box-shadow:var(--shadow-lg); 
            backdrop-filter:blur(10px); 
            border:1px solid rgba(255,255,255,0.2); 
            min-width:280px; 
            max-width:400px;
        }
        .notification.active { 
            display:flex; 
            align-items:center; 
            gap:12px; 
        }
        @keyframes slideInRight { 
            from { transform:translateX(100px); opacity:0; } 
            to { transform:translateX(0); opacity:1; } 
        }
        .notification-icon { font-size:1.3rem; }
        
        /* SEARCH RESULTS */
        .search-result-item { 
            padding:15px; 
            border-bottom:1px solid #FFE0B2; 
            display:flex; 
            gap:12px; 
            align-items:center; 
            cursor:pointer; 
            transition:var(--transition); 
            background:#FFF8F0;
        }
        .search-result-item:hover { 
            background:#FFECB3; 
            transform:translateX(5px); 
        }
        .search-result-image { 
            width:70px; 
            height:50px; 
            border-radius:var(--radius-sm); 
            object-fit:cover; 
            box-shadow:var(--shadow-sm); 
        }
        .search-result-content h4 { 
            margin-bottom:5px; 
            font-size:0.9rem; 
            font-weight:600; 
            color:var(--dark);
        }
        .search-result-content p { 
            font-size:0.8rem; 
            color:var(--gray); 
        }
        
        /* HEADER */
        .header { 
            background:var(--white); 
            box-shadow:0 4px 20px rgba(255, 87, 34, 0.15); 
            position:sticky; 
            top:0; 
            z-index:1000; 
            height:var(--header-height); 
            backdrop-filter:blur(10px); 
            background:rgba(255, 255, 255, 0.95); 
            border-bottom:1px solid #FFE0B2;
        }
        .header-container { 
            display:flex; 
            align-items:center; 
            padding:0 25px; 
            height:100%; 
            max-width:1400px; 
            margin:0 auto; 
            gap:25px; 
        }
        .logo { 
            display:flex; 
            align-items:center; 
            gap:12px; 
            font-size:1.8rem; 
            font-weight:900; 
            color:var(--dark); 
            text-decoration:none; 
        }
        .logo-icon { 
            width:45px; 
            height:45px; 
            background:var(--gradient-primary); 
            border-radius:12px; 
            display:flex; 
            align-items:center; 
            justify-content:center; 
            color:white; 
            box-shadow:0 6px 15px rgba(255, 87, 34, 0.3); 
        }
        .logo-text { 
            background:var(--gradient-primary); 
            -webkit-background-clip:text; 
            -webkit-text-fill-color:transparent; 
        }
        
        .search-container { flex:1; max-width:600px; position:relative; }
        .search-box { 
            width:100%; 
            padding:14px 50px 14px 20px; 
            border:2px solid #FFE0B2; 
            border-radius:30px; 
            font-size:0.95rem; 
            transition:var(--transition); 
            background:#FFF8F0; 
            font-family:'Poppins',sans-serif; 
            color:var(--dark);
        }
        .search-box:focus { 
            border-color:var(--primary); 
            outline:none; 
            box-shadow:0 0 0 3px rgba(255, 87, 34, 0.2); 
            background:white; 
        }
        .search-icon { 
            position:absolute; 
            right:20px; 
            top:50%; 
            transform:translateY(-50%); 
            color:var(--primary); 
            font-size:1.1rem; 
        }
        .search-results { 
            position:absolute; 
            top:calc(100% + 8px); 
            left:0; 
            right:0; 
            background:white; 
            border-radius:var(--radius); 
            box-shadow:var(--shadow-lg); 
            margin-top:8px; 
            display:none; 
            max-height:400px; 
            overflow-y:auto; 
            z-index:1000; 
            border:1px solid #FFE0B2;
        }
        .search-results.active { 
            display:block; 
            animation:fadeInUp 0.3s ease; 
        }
        @keyframes fadeInUp { 
            from { opacity:0; transform:translateY(10px); } 
            to { opacity:1; transform:translateY(0); } 
        }
        
        .nav-actions { display:flex; align-items:center; gap:15px; }
        .user-avatar { 
            width:45px; 
            height:45px; 
            border-radius:50%; 
            background:var(--gradient-primary); 
            color:white; 
            display:flex; 
            align-items:center; 
            justify-content:center; 
            font-weight:700; 
            cursor:pointer; 
            border:2px solid rgba(255,255,255,0.8); 
            transition:var(--transition); 
            box-shadow:0 4px 12px rgba(255, 87, 34, 0.3); 
        }
        .user-avatar:hover { 
            border-color:var(--primary); 
            transform:scale(1.05) rotate(5deg); 
            box-shadow:0 8px 20px rgba(255, 87, 34, 0.4); 
        }
        
        /* POPUP PROFILE */
        .profile-popup { 
            position:fixed; 
            top:80px; 
            right:20px; 
            width:300px; 
            background:white; 
            border-radius:var(--radius); 
            box-shadow:var(--shadow-lg); 
            z-index:1000; 
            display:none; 
            animation:slideDown 0.3s ease; 
            border:1px solid #FFE0B2;
        }
        @keyframes slideDown { 
            from { transform:translateY(-20px) scale(0.95); opacity:0; } 
            to { transform:translateY(0) scale(1); opacity:1; } 
        }
        .profile-popup.active { display:block; }
        .profile-popup-header { 
            padding:25px; 
            background:var(--gradient-primary); 
            color:white; 
            border-radius:var(--radius) var(--radius) 0 0; 
            text-align:center; 
        }
        .profile-popup-avatar { 
            width:80px; 
            height:80px; 
            border-radius:50%; 
            border:3px solid rgba(255,255,255,0.3); 
            background:white; 
            display:flex; 
            align-items:center; 
            justify-content:center; 
            font-size:2.2rem; 
            color:var(--primary); 
            margin:0 auto 12px; 
            box-shadow:0 10px 25px rgba(0,0,0,0.1); 
            transition:var(--transition); 
        }
        .profile-popup-body { padding:20px; }
        .profile-popup-info { text-align:center; margin-bottom:20px; }
        .profile-popup-actions { display:flex; flex-direction:column; gap:10px; }
        .profile-popup-btn { 
            padding:14px; 
            border:none; 
            border-radius:var(--radius-sm); 
            background:#FFF8F0; 
            color:var(--dark); 
            cursor:pointer; 
            display:flex; 
            align-items:center; 
            gap:10px; 
            transition:var(--transition); 
            font-weight:500; 
            font-size:0.9rem; 
        }
        .profile-popup-btn:hover { 
            background:var(--primary); 
            color:white; 
            transform:translateX(5px); 
        }
        
        /* ADS */
        .ad-banner { 
            background:#FFF8F0; 
            border:2px dashed #FFCC80; 
            border-radius:var(--radius); 
            margin:15px 0; 
            display:flex; 
            align-items:center; 
            justify-content:center; 
            overflow:hidden; 
            position:relative; 
            min-height:80px; 
            transition:var(--transition); 
        }
        .ad-banner:hover { 
            border-color:var(--primary); 
            transform:translateY(-3px); 
            box-shadow:var(--shadow); 
        }
        .ad-banner.horizontal { height:100px; }
        .ad-banner.vertical { height:500px; width:200px; }
        .ad-banner.medium { height:250px; width:280px; }
        .ad-label { 
            position:absolute; 
            top:8px; 
            right:8px; 
            background:var(--primary); 
            color:white; 
            padding:4px 12px; 
            border-radius:15px; 
            font-size:0.65rem; 
            font-weight:600; 
            z-index:1; 
        }
        
        /* ADS CONTENT */
        .ad-content { 
            width:100%; 
            height:100%; 
            display:flex; 
            align-items:center; 
            justify-content:center; 
            color:var(--gray); 
            font-style:italic; 
        }
        
        /* MAIN CONTENT */
        .main-content { 
            display:flex; 
            margin-top:25px; 
            gap:25px; 
            padding:0 15px; 
        }
        .content-area { flex:1; min-width:0; }
        .sidebar-left { width:200px; flex-shrink:0; }
        .sidebar-right { width:280px; flex-shrink:0; }
        
        /* ARTICLE */
        .article-header { margin-bottom:30px; position:relative; }
        .article-meta { 
            display:flex; 
            gap:15px; 
            color:var(--gray); 
            margin-bottom:15px; 
            flex-wrap:wrap; 
            font-size:0.9rem;
        }
        .article-title { 
            font-size:2.5rem; 
            line-height:1.2; 
            margin-bottom:20px; 
            font-weight:800; 
            color:var(--dark);
        }
        .article-image { 
            width:100%; 
            height:400px; 
            object-fit:cover; 
            border-radius:var(--radius-lg); 
            margin:25px 0; 
            box-shadow:var(--shadow-lg); 
            transition:var(--transition); 
        }
        .article-image:hover { transform:scale(1.005); }
        .article-content { 
            font-size:1.1rem; 
            line-height:1.7; 
            position:relative; 
            background:white; 
            padding:30px; 
            border-radius:var(--radius); 
            box-shadow:var(--shadow); 
        }
        .article-content p { margin-bottom:20px; }
        .article-content img { 
            max-width:100%; 
            height:auto; 
            border-radius:var(--radius); 
            margin:25px auto; 
            display:block; 
            box-shadow:var(--shadow); 
        }
        
        /* INLINE ADS */
        .inline-ad { margin:30px 0; text-align:center; }
        
        /* ACTION BUTTONS */
        .article-actions { 
            display:flex; 
            gap:12px; 
            margin:30px 0; 
            flex-wrap:wrap; 
        }
        .action-btn { 
            display:flex; 
            align-items:center; 
            gap:10px; 
            padding:12px 20px; 
            background:white; 
            border:none; 
            border-radius:var(--radius); 
            cursor:pointer; 
            transition:var(--transition); 
            font-weight:600; 
            box-shadow:var(--shadow-sm); 
            border:1px solid #FFE0B2; 
        }
        .action-btn:hover { 
            background:#FFF8F0; 
            transform:translateY(-2px); 
            box-shadow:var(--shadow); 
        }
        .action-btn.liked { color:#F44336; background:rgba(244,67,54,0.1); }
        
        /* COMMENTS */
        .comments-section { margin-top:40px; }
        .comment-form { 
            background:white; 
            padding:25px; 
            border-radius:var(--radius); 
            margin-bottom:30px; 
            box-shadow:var(--shadow); 
        }
        .comment-input { 
            width:100%; 
            padding:15px; 
            border:2px solid #FFE0B2; 
            border-radius:var(--radius); 
            margin-bottom:15px; 
            resize:vertical; 
            min-height:100px; 
            font-family:'Poppins',sans-serif; 
            font-size:0.95rem; 
            transition:var(--transition); 
            background:#FFF8F0;
        }
        .comment-input:focus { 
            border-color:var(--primary); 
            outline:none; 
            box-shadow:0 0 0 3px rgba(255, 87, 34, 0.1); 
            background:white;
        }
        .comment-list { margin-top:25px; }
        .comment-item { 
            background:white; 
            padding:20px; 
            border-radius:var(--radius); 
            margin-bottom:15px; 
            border:1px solid #FFE0B2; 
            transition:var(--transition); 
            position:relative; 
            overflow:hidden; 
        }
        .comment-item:hover { 
            transform:translateY(-3px); 
            box-shadow:var(--shadow); 
        }
        .comment-item:before { 
            content:''; 
            position:absolute; 
            top:0; 
            left:0; 
            width:4px; 
            height:100%; 
            background:var(--gradient-primary); 
        }
        .comment-header { 
            display:flex; 
            justify-content:space-between; 
            margin-bottom:12px; 
            align-items:center; 
        }
        .comment-author { 
            font-weight:600; 
            display:flex; 
            align-items:center; 
            gap:10px; 
        }
        .comment-author-avatar { 
            width:36px; 
            height:36px; 
            border-radius:50%; 
            background:var(--gradient-primary); 
            color:white; 
            display:flex; 
            align-items:center; 
            justify-content:center; 
            font-size:1rem; 
            font-weight:700; 
            box-shadow:0 4px 10px rgba(255, 87, 34, 0.3); 
        }
        .comment-time { font-size:0.8rem; color:var(--gray); }
        .comment-actions { margin-top:15px; display:flex; gap:12px; }
        .comment-reply { margin-left:40px; margin-top:15px; padding-left:20px; border-left:2px solid #FFE0B2; }
        
        /* BADGES */
        .trending-badge { 
            background:var(--gradient-warning); 
            color:white; 
            padding:6px 15px; 
            border-radius:20px; 
            font-size:0.8rem; 
            font-weight:700; 
            display:inline-block; 
            margin-left:12px; 
            box-shadow:0 4px 10px rgba(255, 152, 0, 0.3); 
        }
        .new-badge { 
            background:var(--gradient-success); 
            color:white; 
            padding:6px 15px; 
            border-radius:20px; 
            font-size:0.8rem; 
            font-weight:700; 
            display:inline-block; 
            margin-left:12px; 
            box-shadow:0 4px 10px rgba(76, 175, 80, 0.3); 
        }
        
        /* ARTICLE CARD */
        .article-card { 
            background:white; 
            border-radius:var(--radius); 
            overflow:hidden; 
            box-shadow:var(--shadow); 
            transition:var(--transition); 
            cursor:pointer; 
            position:relative; 
        }
        .article-card:hover { 
            transform:translateY(-8px); 
            box-shadow:var(--shadow-lg); 
        }
        .article-card:before { 
            content:''; 
            position:absolute; 
            top:0; 
            left:0; 
            width:100%; 
            height:4px; 
            background:var(--gradient-primary); 
        }
        
        /* CATEGORY BADGES */
        .category-badge { 
            display:inline-block; 
            padding:6px 15px; 
            border-radius:20px; 
            font-size:0.8rem; 
            font-weight:600; 
            margin-right:8px; 
            margin-bottom:8px; 
        }
        .category-misteri { background:linear-gradient(135deg, #FF9800, #FF5722); color:white; }
        .category-fakta { background:linear-gradient(135deg, #4CAF50, #388E3C); color:white; }
        .category-teknologi { background:linear-gradient(135deg, #2196F3, #1976D2); color:white; }
        .category-viral { background:linear-gradient(135deg, #F44336, #D32F2F); color:white; }
        .category-sejarah { background:linear-gradient(135deg, #795548, #5D4037); color:white; }
        .category-hiburan { background:linear-gradient(135deg, #9C27B0, #7B1FA2); color:white; }
        .category-olahraga { background:linear-gradient(135deg, #009688, #00796B); color:white; }
        .category-kesehatan { background:linear-gradient(135deg, #00BCD4, #0097A7); color:white; }
        .category-bisnis { background:linear-gradient(135deg, #607D8B, #455A64); color:white; }
        .category-pendidikan { background:linear-gradient(135deg, #FFEB3B, #FBC02D); color:var(--dark); }
        .category-politik { background:linear-gradient(135deg, #3F51B5, #303F9F); color:white; }
        .category-otomotif { background:linear-gradient(135deg, #9E9E9E, #616161); color:white; }
        .category-kuliner { background:linear-gradient(135deg, #FF5722, #E64A19); color:white; }
        .category-wisata { background:linear-gradient(135deg, #4CAF50, #388E3C); color:white; }
        .category-fashion { background:linear-gradient(135deg, #E91E63, #C2185B); color:white; }
        
        /* STATS CARDS */
        .stats-card { 
            background:white; 
            padding:20px; 
            border-radius:var(--radius); 
            box-shadow:var(--shadow); 
            text-align:center; 
            transition:var(--transition); 
        }
        .stats-card:hover { 
            transform:translateY(-3px); 
            box-shadow:var(--shadow-lg); 
        }
        .stats-card-value { 
            font-size:2rem; 
            font-weight:800; 
            margin-bottom:8px; 
        }
        .stats-card-label { color:var(--gray); font-size:0.85rem; }
        
        /* RESPONSIVE */
        @media (max-width: 1200px) {
            .sidebar-left { display:none; }
            .sidebar-right { width:250px; }
        }
        @media (max-width: 992px) {
            .sidebar-right { display:none; }
            .search-container { display:none; }
        }
        @media (max-width: 768px) {
            .header-container { padding:0 15px; gap:15px; }
            .logo-text { font-size:1.4rem; }
            .logo-icon { width:35px; height:35px; }
            .article-title { font-size:1.8rem; }
            .article-image { height:250px; }
            .profile-popup { width:280px; right:10px; }
            .article-content { padding:20px; }
            .main-content { padding:0 10px; gap:15px; }
            .article-meta { font-size:0.8rem; }
            .btn { padding:10px 18px; font-size:0.9rem; }
        }
        
        /* LOADING ANIMATION */
        .loading-spinner { 
            display:inline-block; 
            width:40px; 
            height:40px; 
            border:4px solid rgba(255, 87, 34, 0.1); 
            border-radius:50%; 
            border-top-color:var(--primary); 
            animation:spin 1s ease-in-out infinite; 
        }
        @keyframes spin { to { transform:rotate(360deg); } }
        
        /* CARD HOVER EFFECTS */
        .hover-lift { transition:var(--transition); }
        .hover-lift:hover { transform:translateY(-3px); }
        
        /* FIX ADS IFRAME ISSUE */
        .ad-banner iframe {
            width: 100% !important;
            height: 100% !important;
            border: none !important;
            overflow: hidden !important;
        }
        
        /* ORANGE THEME OVERRIDES */
        ::selection {
            background: rgba(255, 152, 0, 0.3);
            color: var(--dark);
        }
        
        a {
            color: var(--primary);
            text-decoration: none;
            transition: var(--transition);
        }
        
        a:hover {
            color: var(--secondary);
            text-decoration: underline;
        }
        
        input, textarea, select {
            font-family: 'Poppins', sans-serif;
        }
        
        /* SCROLLBAR */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #FFF8F0;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--secondary);
        }

        /* BANNER ARTIKEL HEADLINE */
        .headline-banner {
            position: relative;
            height: 400px;
            border-radius: var(--radius-lg);
            overflow: hidden;
            margin-bottom: 30px;
            cursor: pointer;
        }
        
        .headline-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }
        
        .headline-banner:hover .headline-image {
            transform: scale(1.05);
        }
        
        .headline-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
            padding: 30px;
            color: white;
        }
        
        .headline-category {
            background: var(--primary);
            color: white;
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            display: inline-block;
            margin-bottom: 12px;
        }
        
        .headline-title {
            font-size: 2rem;
            font-weight: 800;
            margin-bottom: 10px;
            line-height: 1.2;
        }
        
        .headline-meta {
            display: flex;
            gap: 15px;
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        /* SIDEBAR CATEGORIES EXPANDABLE */
        .categories-toggle {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            padding: 15px;
            background: white;
            border-radius: var(--radius);
            margin-bottom: 15px;
            border: 1px solid #FFE0B2;
            transition: var(--transition);
        }
        
        .categories-toggle:hover {
            background: #FFF8F0;
            transform: translateY(-2px);
        }
        
        .categories-content {
            background: white;
            border-radius: var(--radius);
            padding: 15px;
            border: 1px solid #FFE0B2;
            display: none;
        }
        
        .categories-content.active {
            display: block;
        }
        
        /* LEADERBOARD PAGE */
        .leaderboard-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: white;
            border-radius: var(--radius);
            margin-bottom: 12px;
            border: 1px solid #FFE0B2;
            transition: var(--transition);
        }
        
        .leaderboard-item:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }
        
        .leaderboard-rank {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--primary);
            min-width: 40px;
            text-align: center;
        }
        
        /* SUPPORT MODAL STYLES */
        .support-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .support-option {
            padding: 20px;
            border-radius: var(--radius);
            text-align: center;
            border: 2px solid #FFE0B2;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .support-option:hover {
            border-color: var(--primary);
            transform: translateY(-3px);
        }
        
        .support-option.active {
            border-color: var(--primary);
            background: #FFF8F0;
        }
        
        .support-option-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: var(--primary);
        }
    </style>
</head>
<body>
    <!-- ==================== HEADER ==================== -->
    <header class="header">
        <div class="header-container">
            <a href="#" class="logo" onclick="showHomePage(); return false;">
                <div class="logo-icon">
                    <i class="fas fa-newspaper"></i>
                </div>
                <span class="logo-text">NexeNews</span>
            </a>
            
            <div class="search-container">
                <input type="text" class="search-box" id="searchBox" placeholder="Cari artikel viral...">
                <i class="fas fa-search search-icon"></i>
                <div class="search-results" id="searchResults"></div>
            </div>
            
            <div class="nav-actions">
                <button class="btn btn-secondary" id="leaderboardBtn" onclick="showLeaderboard()">
                    <i class="fas fa-trophy"></i> Leaderboard
                </button>
                <button class="btn btn-secondary" id="supportBtn" onclick="showSupportOptions()">
                    <i class="fas fa-heart"></i> Support
                </button>
                <button class="btn btn-secondary" id="loginBtn">
                    <i class="fas fa-sign-in-alt"></i> Masuk
                </button>
                <div class="user-avatar" id="userAvatar" style="display:none;">?</div>
            </div>
        </div>
    </header>
    
    <!-- ==================== POPUP PROFILE ==================== -->
    <div class="profile-popup" id="profilePopup">
        <div class="profile-popup-header">
            <div class="profile-popup-avatar" id="popupAvatar">U</div>
            <h3 id="popupUsername" style="font-size:1.2rem; margin-bottom:5px;">Username</h3>
            <p id="popupEmail" style="opacity:0.9; font-size:0.85rem;">user@email.com</p>
        </div>
        <div class="profile-popup-body">
            <div class="profile-popup-info">
                <div style="display:flex; gap:20px; justify-content:center; margin-bottom:20px;">
                    <div class="stats-card" style="padding:12px; min-width:70px;">
                        <div style="font-size:1.5rem; font-weight:800;" id="popupArticles">0</div>
                        <div style="font-size:0.75rem; color:var(--gray);">Artikel</div>
                    </div>
                    <div class="stats-card" style="padding:12px; min-width:70px;">
                        <div style="font-size:1.5rem; font-weight:800;" id="popupLikes">0</div>
                        <div style="font-size:0.75rem; color:var(--gray);">Likes</div>
                    </div>
                </div>
            </div>
            <div class="profile-popup-actions">
                <button class="profile-popup-btn" id="popupProfileBtn">
                    <i class="fas fa-user-circle"></i> Profil Saya
                </button>
                <button class="profile-popup-btn" id="popupMyArticlesBtn">
                    <i class="fas fa-newspaper"></i> Artikel Saya
                </button>
                <button class="profile-popup-btn" id="popupAdminBtn" style="display:none;">
                    <i class="fas fa-crown"></i> Admin Panel
                </button>
                <button class="profile-popup-btn" id="popupLogoutBtn" style="color:var(--danger);">
                    <i class="fas fa-sign-out-alt"></i> Keluar
                </button>
            </div>
        </div>
    </div>
    
    <!-- ==================== MODALS ==================== -->
    <div class="modal" id="loginModal">
        <div class="modal-content" style="max-width:450px;">
            <div class="modal-header">
                <h2 style="font-size:1.5rem;"><i class="fas fa-user-circle"></i> Masuk / Daftar</h2>
                <button class="modal-close" id="closeLoginModal">&times;</button>
            </div>
            <div class="modal-body">
                <div style="text-align:center; margin-bottom:25px;">
                    <div style="width:70px; height:70px; background:var(--gradient-primary); border-radius:50%; display:flex; align-items:center; justify-content:center; margin:0 auto 15px; color:white; font-size:2rem;">
                        <i class="fas fa-user"></i>
                    </div>
                    <h3 style="margin-bottom:8px; font-size:1.3rem;">Selamat Datang di NexeNews</h3>
                    <p style="color:var(--gray); font-size:0.9rem;">Buat artikel, like, dan komentari berita viral</p>
                </div>
                
                <div style="margin-bottom:20px;">
                    <div style="margin-bottom:15px;">
                        <label style="display:block; margin-bottom:8px; font-weight:600; color:var(--dark); font-size:0.9rem;">Nama Pengguna</label>
                        <input type="text" id="loginUsername" placeholder="Masukkan username" style="width:100%; padding:12px; border:2px solid #FFE0B2; border-radius:var(--radius); font-family:'Poppins',sans-serif; font-size:0.95rem; background:#FFF8F0;">
                    </div>
                    
                    <div style="margin-bottom:15px;">
                        <label style="display:block; margin-bottom:8px; font-weight:600; color:var(--dark); font-size:0.9rem;">Email (Opsional)</label>
                        <input type="email" id="loginEmail" placeholder="email@example.com" style="width:100%; padding:12px; border:2px solid #FFE0B2; border-radius:var(--radius); font-family:'Poppins',sans-serif; font-size:0.95rem; background:#FFF8F0;">
                    </div>
                    
                    <div style="margin-bottom:20px;">
                        <label style="display:block; margin-bottom:8px; font-weight:600; color:var(--dark); font-size:0.9rem;">Password</label>
                        <input type="password" id="loginPassword" placeholder="Minimal 6 karakter" style="width:100%; padding:12px; border:2px solid #FFE0B2; border-radius:var(--radius); font-family:'Poppins',sans-serif; font-size:0.95rem; background:#FFF8F0;">
                    </div>
                </div>
                
                <button class="btn btn-primary btn-lg" id="submitLoginBtn" style="width:100%; margin-bottom:12px; font-size:1rem;">
                    <i class="fas fa-user-plus"></i> Masuk / Daftar
                </button>
                
                <div style="text-align:center; margin-top:20px; padding-top:20px; border-top:1px solid #FFE0B2;">
                    <p style="color:var(--gray); font-size:0.85rem;">Dengan masuk, kamu bisa buat artikel, like, dan komentar</p>
                </div>
            </div>
        </div>
    </div>
    
    <div class="modal" id="supportModal">
        <div class="modal-content" style="max-width:600px;">
            <div class="modal-header" style="background:var(--gradient-warning);">
                <h2 style="font-size:1.5rem;"><i class="fas fa-heart"></i> Dukung NexeNews</h2>
                <button class="modal-close" id="closeSupportModal">&times;</button>
            </div>
            <div class="modal-body">
                <div style="text-align:center; margin-bottom:25px;">
                    <div style="width:80px; height:80px; background:var(--gradient-warning); border-radius:50%; display:flex; align-items:center; justify-content:center; margin:0 auto 20px; color:white; font-size:2.5rem;">
                        <i class="fas fa-heart"></i>
                    </div>
                    <h3 style="margin-bottom:12px; font-size:1.3rem;">Pilih Cara Support</h3>
                    <p style="color:var(--gray); font-size:0.95rem;">Bantu platform ini tetap gratis untuk semua orang</p>
                </div>
                
                <div class="support-options">
                    <div class="support-option" id="supportFree" onclick="selectSupportOption('free')">
                        <div class="support-option-icon">
                            <i class="fas fa-hands-helping"></i>
                        </div>
                        <h4 style="margin-bottom:10px; font-size:1.1rem;">Support Gratis</h4>
                        <p style="color:var(--gray); font-size:0.9rem;">Klik iklan untuk mendukung</p>
                    </div>
                    
                    <div class="support-option" id="supportSaweria" onclick="selectSupportOption('saweria')">
                        <div class="support-option-icon">
                            <i class="fas fa-donate"></i>
                        </div>
                        <h4 style="margin-bottom:10px; font-size:1.1rem;">Donasi Saweria</h4>
                        <p style="color:var(--gray); font-size:0.9rem;">Donasi langsung ke developer</p>
                    </div>
                </div>
                
                <div id="supportFreeContent" style="display:none;">
                    <div style="background:#FFF8F0; padding:20px; border-radius:var(--radius); margin-bottom:20px; border:1px solid #FFE0B2;">
                        <h4 style="margin-bottom:15px; color:var(--primary); font-size:1.1rem;">Support dengan Iklan</h4>
                        <p style="margin-bottom:15px; line-height:1.6; font-size:0.95rem;">Dengan mengklik iklan di bawah, kamu membantu platform ini mendapatkan penghasilan tanpa biaya apapun untukmu!</p>
                        <button class="btn btn-warning" onclick="supportWithAds()" style="width:100%;">
                            <i class="fas fa-external-link-alt"></i> Klik Iklan untuk Support
                        </button>
                    </div>
                </div>
                
                <div id="supportSaweriaContent" style="display:none;">
                    <div style="background:#FFF8F0; padding:20px; border-radius:var(--radius); margin-bottom:20px; border:1px solid #FFE0B2;">
                        <h4 style="margin-bottom:15px; color:var(--primary); font-size:1.1rem;">Donasi via Saweria</h4>
                        <p style="margin-bottom:15px; line-height:1.6; font-size:0.95rem;">Donasi langsung membantu developer mengembangkan platform ini lebih baik lagi.</p>
                        <div style="background:white; padding:15px; border-radius:var(--radius); margin-bottom:15px; border:1px solid #FFE0B2;">
                            <div style="font-weight:600; margin-bottom:5px;">Link Saweria:</div>
                            <div style="font-family:monospace; background:#FFE0B2; padding:10px; border-radius:var(--radius-sm); word-break:break-all;">
                                saweria.co/omedonation
                            </div>
                        </div>
                        <button class="btn btn-success" onclick="openSaweria()" style="width:100%;">
                            <i class="fas fa-external-link-alt"></i> Buka Saweria
                        </button>
                    </div>
                </div>
                
                <div style="text-align:center; padding-top:20px; border-top:1px solid #FFE0B2;">
                    <p style="color:var(--gray); font-size:0.85rem;">Terima kasih atas dukunganmu!</p>
                </div>
            </div>
        </div>
    </div>
    
    <div class="modal" id="createArticleModal">
        <div class="modal-content" style="max-width:700px;">
            <div class="modal-header">
                <h2 style="font-size:1.5rem;"><i class="fas fa-edit"></i> Buat Artikel Baru</h2>
                <button class="modal-close" id="closeCreateModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group" style="margin-bottom:20px;">
                    <label style="display:block; margin-bottom:8px; font-weight:600; color:var(--dark); font-size:0.9rem;">Judul Artikel</label>
                    <input type="text" id="articleTitleInput" placeholder="Judul yang menarik..." style="width:100%; padding:12px; border:2px solid #FFE0B2; border-radius:var(--radius); font-family:'Poppins',sans-serif; font-size:1rem; background:#FFF8F0;">
                </div>
                
                <div class="form-group" style="margin-bottom:20px;">
                    <label style="display:block; margin-bottom:8px; font-weight:600; color:var(--dark); font-size:0.9rem;">Kategori</label>
                    <select id="articleCategoryInput" style="width:100%; padding:12px; border:2px solid #FFE0B2; border-radius:var(--radius); font-family:'Poppins',sans-serif; background:white; font-size:0.95rem;">
                        <option value="misteri">üîÆ Misteri & Horor</option>
                        <option value="fakta">üí° Fakta Unik</option>
                        <option value="sejarah">üèõÔ∏è Sejarah</option>
                        <option value="teknologi">üíª Teknologi</option>
                        <option value="viral">üî• Viral</option>
                        <option value="hiburan">üé¨ Hiburan</option>
                        <option value="olahraga">‚öΩ Olahraga</option>
                        <option value="kesehatan">üíä Kesehatan</option>
                        <option value="bisnis">üíº Bisnis</option>
                        <option value="pendidikan">üéì Pendidikan</option>
                        <option value="politik">üèõÔ∏è Politik</option>
                        <option value="otomotif">üöó Otomotif</option>
                        <option value="kuliner">üçú Kuliner</option>
                        <option value="wisata">üå¥ Wisata</option>
                        <option value="fashion">üëó Fashion</option>
                    </select>
                </div>
                
                <div class="form-group" style="margin-bottom:20px;">
                    <label style="display:block; margin-bottom:8px; font-weight:600; color:var(--dark); font-size:0.9rem;">Gambar Utama (URL)</label>
                    <input type="text" id="articleImageInput" placeholder="https://example.com/gambar.jpg" style="width:100%; padding:12px; border:2px solid #FFE0B2; border-radius:var(--radius); font-family:'Poppins',sans-serif; font-size:0.95rem; background:#FFF8F0;">
                </div>
                
                <div class="form-group" style="margin-bottom:20px;">
                    <label style="display:block; margin-bottom:8px; font-weight:600; color:var(--dark); font-size:0.9rem;">Konten Artikel</label>
                    <div id="articleEditor" style="height:300px; border-radius:var(--radius); overflow:hidden; border:2px solid #FFE0B2;"></div>
                </div>
                
                <div class="form-group" style="margin-bottom:25px;">
                    <label style="display:block; margin-bottom:8px; font-weight:600; color:var(--dark); font-size:0.9rem;">Slug URL (otomatis dari judul)</label>
                    <input type="text" id="articleSlugInput" readonly style="width:100%; padding:12px; background:#FFF8F0; border:2px solid #FFE0B2; border-radius:var(--radius); color:var(--gray); font-family:'Poppins',sans-serif; font-size:0.95rem;">
                </div>
                
                <button class="btn btn-success btn-lg" id="publishArticleBtn" style="width:100%;">
                    <i class="fas fa-paper-plane"></i> Ajukan Artikel
                </button>
            </div>
        </div>
    </div>
    
    <!-- ==================== MAIN CONTENT ==================== -->
    <div class="container main-content">
        <!-- LEFT SIDEBAR -->
        <aside class="sidebar-left">
            <!-- PropellerAds Vertical -->
            <div class="ad-banner vertical" style="margin-bottom:25px;">
                <span class="ad-label">IKLAN</span>
                <div class="ad-content">
                    <div data-zone="10380855"></div>
                </div>
            </div>
            
            <!-- CATEGORIES TOGGLE -->
            <div class="categories-toggle" id="categoriesToggle">
                <h3 style="color:var(--primary); font-size:1.1rem; display:flex; align-items:center; gap:8px;">
                    <i class="fas fa-tags"></i> Kategori
                </h3>
                <i class="fas fa-chevron-down"></i>
            </div>
            
            <!-- CATEGORIES CONTENT -->
            <div class="categories-content" id="categoriesContent">
                <div style="display:flex; flex-wrap:wrap; gap:8px;">
                    <span class="category-badge category-misteri" onclick="filterCategory('misteri')">üîÆ Misteri</span>
                    <span class="category-badge category-fakta" onclick="filterCategory('fakta')">üí° Fakta</span>
                    <span class="category-badge category-teknologi" onclick="filterCategory('teknologi')">üíª Teknologi</span>
                    <span class="category-badge category-viral" onclick="filterCategory('viral')">üî• Viral</span>
                    <span class="category-badge category-sejarah" onclick="filterCategory('sejarah')">üèõÔ∏è Sejarah</span>
                    <span class="category-badge category-hiburan" onclick="filterCategory('hiburan')">üé¨ Hiburan</span>
                    <span class="category-badge category-olahraga" onclick="filterCategory('olahraga')">‚öΩ Olahraga</span>
                    <span class="category-badge category-kesehatan" onclick="filterCategory('kesehatan')">üíä Kesehatan</span>
                    <span class="category-badge category-bisnis" onclick="filterCategory('bisnis')">üíº Bisnis</span>
                    <span class="category-badge category-pendidikan" onclick="filterCategory('pendidikan')">üéì Pendidikan</span>
                    <span class="category-badge category-politik" onclick="filterCategory('politik')">üèõÔ∏è Politik</span>
                    <span class="category-badge category-otomotif" onclick="filterCategory('otomotif')">üöó Otomotif</span>
                    <span class="category-badge category-kuliner" onclick="filterCategory('kuliner')">üçú Kuliner</span>
                    <span class="category-badge category-wisata" onclick="filterCategory('wisata')">üå¥ Wisata</span>
                    <span class="category-badge category-fashion" onclick="filterCategory('fashion')">üëó Fashion</span>
                </div>
            </div>
        </aside>
        
        <!-- MAIN CONTENT AREA -->
        <main class="content-area">
            <!-- HOME PAGE -->
            <div id="homePage">
                <!-- HEADLINE BANNER -->
                <div id="headlineBanner" class="headline-banner" style="display:none;">
                    <img src="" alt="Headline" class="headline-image">
                    <div class="headline-overlay">
                        <span class="headline-category" id="headlineCategory"></span>
                        <h2 class="headline-title" id="headlineTitle"></h2>
                        <div class="headline-meta">
                            <span><i class="far fa-eye"></i> <span id="headlineViews">0</span> views</span>
                            <span><i class="fas fa-heart"></i> <span id="headlineLikes">0</span> likes</span>
                            <span><i class="far fa-clock"></i> <span id="headlineTime"></span></span>
                        </div>
                    </div>
                </div>
                
                <!-- PropellerAds Top -->
                <div class="ad-banner horizontal" style="margin-bottom:25px;">
                    <span class="ad-label">IKLAN</span>
                    <div class="ad-content">
                        <div data-zone="10380831"></div>
                    </div>
                </div>
                
                <!-- TRENDING ARTICLES -->
                <section style="margin:30px 0;">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:25px;">
                        <h2 style="color:var(--dark); font-weight:800; font-size:1.8rem; display:flex; align-items:center; gap:12px;">
                            <i class="fas fa-fire" style="color:#F44336;"></i> Trending Viral
                        </h2>
                        <span style="font-size:0.85rem; color:var(--gray); font-weight:500;">Algoritma: Views + Likes + Comments</span>
                    </div>
                    <div id="trendingArticles" style="display:grid; grid-template-columns:repeat(auto-fill, minmax(300px, 1fr)); gap:25px;">
                        <!-- Trending articles loaded here -->
                        <div style="grid-column:1/-1; text-align:center; padding:50px 20px; background:white; border-radius:var(--radius); box-shadow:var(--shadow); border:1px solid #FFE0B2;">
                            <div class="loading-spinner" style="margin:0 auto 20px;"></div>
                            <h3 style="margin-bottom:12px; color:var(--dark); font-size:1.2rem;">Memuat artikel trending...</h3>
                            <p style="color:var(--gray); font-size:0.9rem;">Sedang mengambil data terbaru</p>
                        </div>
                    </div>
                </section>
                
                <!-- PropellerAds Mid -->
                <div class="ad-banner horizontal" style="margin:30px 0;">
                    <span class="ad-label">IKLAN</span>
                    <div class="ad-content">
                        <div data-zone="10380895"></div>
                    </div>
                </div>
                
                <!-- NEWEST ARTICLES -->
                <section style="margin:40px 0;">
                    <h2 style="margin-bottom:25px; color:var(--dark); font-weight:800; font-size:1.8rem; display:flex; align-items:center; gap:12px;">
                        <i class="fas fa-clock" style="color:var(--primary);"></i> Terbaru
                    </h2>
                    <div id="newestArticles" style="display:grid; grid-template-columns:repeat(auto-fill, minmax(300px, 1fr)); gap:25px;">
                        <!-- Newest articles loaded here -->
                    </div>
                </section>
                
                <!-- Bottom ADS -->
                <div class="ad-banner horizontal" style="margin-top:40px; margin-bottom:20px;">
                    <span class="ad-label">IKLAN</span>
                    <div class="ad-content">
                        <div data-zone="10380855"></div>
                    </div>
                </div>
            </div>
            
            <!-- ARTICLE READING PAGE -->
            <div id="articlePage" style="display:none;">
                <article>
                    <div class="article-header">
                        <div class="article-meta">
                            <span><i class="far fa-calendar"></i> <span id="articleDate">-</span></span>
                            <span><i class="far fa-eye"></i> <span id="articleViews">0</span> views</span>
                            <span><i class="fas fa-heart"></i> <span id="articleLikes">0</span> likes</span>
                            <span><i class="fas fa-comment"></i> <span id="articleComments">0</span> komentar</span>
                        </div>
                        <h1 class="article-title" id="articleTitle"></h1>
                        <div style="display:flex; align-items:center; gap:15px; margin-top:15px; padding:15px; background:white; border-radius:var(--radius); box-shadow:var(--shadow-sm); border:1px solid #FFE0B2;">
                            <div id="authorAvatar" style="width:50px; height:50px; border-radius:50%; background:var(--gradient-primary); color:white; display:flex; align-items:center; justify-content:center; font-weight:bold; font-size:1.3rem; box-shadow:0 4px 12px rgba(255, 87, 34, 0.3);"></div>
                            <div style="flex:1;">
                                <div style="font-weight:700; font-size:1rem;" id="authorName"></div>
                                <div style="font-size:0.85rem; color:var(--gray);" id="articleTimestamp"></div>
                            </div>
                            <span class="category-badge" id="articleCategoryBadge" style="margin:0;"></span>
                        </div>
                    </div>
                    
                    <img id="articleImage" class="article-image" alt="Article Image">
                    
                    <!-- PropellerAds In-Article -->
                    <div class="inline-ad" style="margin:30px 0;">
                        <div class="ad-banner horizontal" style="height:90px;">
                            <span class="ad-label">IKLAN</span>
                            <div class="ad-content">
                                <div data-zone="10380895"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="article-content" id="articleContent">
                        <div style="text-align:center; padding:50px 20px;">
                            <div class="loading-spinner" style="margin:0 auto 20px;"></div>
                            <h3 style="margin-bottom:12px; color:var(--dark); font-size:1.2rem;">Memuat konten artikel...</h3>
                        </div>
                    </div>
                    
                    <!-- ACTION BUTTONS -->
                    <div class="article-actions">
                        <button class="action-btn" id="likeArticleBtn">
                            <i class="far fa-heart"></i> <span id="likeText">Suka</span>
                        </button>
                        <button class="action-btn" id="shareArticleBtn">
                            <i class="fas fa-share-alt"></i> Share
                        </button>
                        <button class="btn btn-primary" id="readMoreBtn" style="margin-left:auto;" onclick="showHomePage()">
                            <i class="fas fa-book-open"></i> Baca Artikel Lain
                        </button>
                    </div>
                    
                    <!-- COMMENTS SECTION -->
                    <div class="comments-section">
                        <h3 style="margin-bottom:20px; color:var(--dark); font-size:1.3rem; font-weight:700; display:flex; align-items:center; gap:8px;">
                            <i class="fas fa-comments"></i> Komentar (<span id="commentCount">0</span>)
                        </h3>
                        
                        <!-- COMMENT FORM -->
                        <div class="comment-form" id="commentForm" style="display:none;">
                            <h4 style="margin-bottom:15px; color:var(--dark); font-size:1.1rem;">Tambah Komentar</h4>
                            <textarea class="comment-input" id="commentInput" placeholder="Bagaimana pendapatmu tentang artikel ini?"></textarea>
                            <div style="display:flex; justify-content:space-between; align-items:center;">
                                <button class="btn btn-primary" id="submitCommentBtn">
                                    <i class="fas fa-paper-plane"></i> Kirim Komentar
                                </button>
                                <div>
                                    <span id="charCount" style="font-size:0.8rem; color:var(--gray);">0/500</span>
                                    <span style="font-size:0.8rem; color:var(--gray); margin-left:12px;">Max 500 karakter</span>
                                </div>
                            </div>
                        </div>
                        <div id="loginToComment" style="text-align:center; padding:30px; background:white; border-radius:var(--radius); box-shadow:var(--shadow); border:1px solid #FFE0B2;">
                            <div style="width:70px; height:70px; background:var(--gradient-primary); border-radius:50%; display:flex; align-items:center; justify-content:center; margin:0 auto 15px; color:white; font-size:1.8rem;">
                                <i class="fas fa-comment"></i>
                            </div>
                            <p style="margin-bottom:15px; font-size:1rem;">Login untuk menambahkan komentar</p>
                            <button class="btn btn-primary" id="loginForCommentBtn">
                                <i class="fas fa-sign-in-alt"></i> Login Sekarang
                            </button>
                        </div>
                        
                        <!-- COMMENTS LIST -->
                        <div class="comment-list" id="commentList">
                            <div style="text-align:center; padding:30px; color:var(--gray);">
                                <i class="far fa-comment" style="font-size:2.5rem; margin-bottom:12px; opacity:0.5;"></i>
                                <p>Belum ada komentar. Jadilah yang pertama berkomentar!</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Bottom of article ADS -->
                    <div class="inline-ad" style="margin-top:40px;">
                        <div class="ad-banner horizontal">
                            <span class="ad-label">IKLAN</span>
                            <div class="ad-content">
                                <div data-zone="10380831"></div>
                            </div>
                        </div>
                    </div>
                </article>
            </div>
            
            <!-- LEADERBOARD PAGE -->
            <div id="leaderboardPage" style="display:none;">
                <div style="max-width:900px; margin:0 auto;">
                    <div style="background:var(--gradient-primary); color:white; padding:30px; border-radius:var(--radius-lg); margin-bottom:30px; text-align:center;">
                        <h1 style="font-size:2.5rem; margin-bottom:15px; font-weight:900;"><i class="fas fa-trophy"></i> Leaderboard</h1>
                        <p style="opacity:0.9; font-size:1.1rem;">Artikel terpopuler berdasarkan skor trending</p>
                    </div>
                    
                    <div style="background:white; border-radius:var(--radius); padding:25px; box-shadow:var(--shadow); border:1px solid #FFE0B2; margin-bottom:30px;">
                        <h3 style="margin-bottom:20px; color:var(--primary); font-size:1.3rem; display:flex; align-items:center; gap:12px;">
                            <i class="fas fa-chart-line"></i> Skor Trending
                        </h3>
                        <div style="display:flex; justify-content:space-around; margin-bottom:25px; flex-wrap:wrap; gap:15px;">
                            <div style="text-align:center; padding:15px; min-width:150px; background:#FFF8F0; border-radius:var(--radius);">
                                <div style="font-size:2rem; font-weight:800; color:var(--primary);">0.6</div>
                                <div style="font-size:0.9rem; color:var(--gray);">Views Weight</div>
                            </div>
                            <div style="text-align:center; padding:15px; min-width:150px; background:#FFF8F0; border-radius:var(--radius);">
                                <div style="font-size:2rem; font-weight:800; color:var(--success);">1.0</div>
                                <div style="font-size:0.9rem; color:var(--gray);">Likes Weight</div>
                            </div>
                            <div style="text-align:center; padding:15px; min-width:150px; background:#FFF8F0; border-radius:var(--radius);">
                                <div style="font-size:2rem; font-weight:800; color:var(--info);">1.5</div>
                                <div style="font-size:0.9rem; color:var(--gray);">Comments Weight</div>
                            </div>
                        </div>
                        <p style="color:var(--gray); font-size:0.9rem; text-align:center;">Skor = (Views √ó 0.6) + (Likes √ó 1.0) + (Comments √ó 1.5) √ó Time Decay</p>
                    </div>
                    
                    <div id="leaderboardList">
                        <div style="text-align:center; padding:50px 20px; color:var(--gray);">
                            <div class="loading-spinner" style="margin:0 auto 20px;"></div>
                            <p>Memuat leaderboard...</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- PROFILE PAGE -->
            <div id="profilePage" style="display:none;">
                <div style="max-width:800px; margin:0 auto;">
                    <!-- PROFILE HEADER -->
                    <div style="background:var(--gradient-primary); color:white; padding:40px; border-radius:var(--radius-lg); margin-bottom:30px; position:relative; overflow:hidden; box-shadow:var(--shadow-lg);">
                        <div style="position:absolute; top:-80px; right:-80px; width:250px; height:250px; background:rgba(255,255,255,0.1); border-radius:50%;"></div>
                        <div style="position:absolute; bottom:-40px; left:-40px; width:150px; height:150px; background:rgba(255,255,255,0.05); border-radius:50%;"></div>
                        
                        <div style="display:flex; align-items:center; gap:30px; flex-wrap:wrap; position:relative; z-index:1;">
                            <div id="profileBigAvatar" style="width:120px; height:120px; border-radius:50%; border:4px solid rgba(255,255,255,0.3); background:white; display:flex; align-items:center; justify-content:center; font-size:3rem; color:var(--primary); box-shadow:0 15px 30px rgba(0,0,0,0.2);"></div>
                            <div style="flex:1;">
                                <h1 id="profileBigUsername" style="font-size:2.2rem; margin-bottom:12px; font-weight:900;"></h1>
                                <p id="profileBigEmail" style="opacity:0.9; margin-bottom:25px; font-size:1rem;"></p>
                                <div style="display:flex; gap:30px;">
                                    <div class="stats-card" style="background:rgba(255,255,255,0.2); backdrop-filter:blur(10px); color:white; min-width:100px; padding:15px;">
                                        <div style="font-size:2rem; font-weight:800;" id="profileBigArticles">0</div>
                                        <div>Artikel</div>
                                    </div>
                                    <div class="stats-card" style="background:rgba(255,255,255,0.2); backdrop-filter:blur(10px); color:white; min-width:100px; padding:15px;">
                                        <div style="font-size:2rem; font-weight:800;" id="profileBigLikes">0</div>
                                        <div>Likes</div>
                                    </div>
                                    <div class="stats-card" style="background:rgba(255,255,255,0.2); backdrop-filter:blur(10px); color:white; min-width:100px; padding:15px;">
                                        <div style="font-size:2rem; font-weight:800;" id="profileBigViews">0</div>
                                        <div>Views</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- EDIT PROFILE -->
                    <div class="glass-effect" style="padding:30px; border-radius:var(--radius); margin-bottom:30px; border:1px solid #FFE0B2;">
                        <h3 style="margin-bottom:25px; color:var(--primary); font-size:1.3rem; display:flex; align-items:center; gap:12px;">
                            <i class="fas fa-user-edit"></i> Edit Profil
                        </h3>
                        <div style="display:grid; grid-template-columns:1fr 1fr; gap:25px; margin-bottom:25px;">
                            <div>
                                <label style="display:block; margin-bottom:10px; font-weight:600; color:var(--dark); font-size:0.9rem;">Username</label>
                                <div style="display:flex; gap:12px;">
                                    <input type="text" id="editUsername" style="flex:1; padding:12px; border:2px solid #FFE0B2; border-radius:var(--radius); font-family:'Poppins',sans-serif; font-size:0.95rem; background:#FFF8F0;">
                                    <button class="btn btn-primary btn-icon" id="saveUsernameBtn">
                                        <i class="fas fa-check"></i>
                                    </button>
                                </div>
                            </div>
                            <div>
                                <label style="display:block; margin-bottom:10px; font-weight:600; color:var(--dark); font-size:0.9rem;">Email</label>
                                <div style="display:flex; gap:12px;">
                                    <input type="email" id="editEmail" placeholder="email@example.com" style="flex:1; padding:12px; border:2px solid #FFE0B2; border-radius:var(--radius); font-family:'Poppins',sans-serif; font-size:0.95rem; background:#FFF8F0;">
                                    <button class="btn btn-primary btn-icon" id="saveEmailBtn">
                                        <i class="fas fa-check"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div style="background:#FFF8F0; padding:20px; border-radius:var(--radius); border:1px solid #FFE0B2;">
                            <h4 style="margin-bottom:12px; color:var(--dark); font-size:1rem; display:flex; align-items:center; gap:8px;">
                                <i class="fas fa-info-circle"></i> Informasi Akun
                            </h4>
                            <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px;">
                                <div>
                                    <p style="margin-bottom:6px; color:var(--gray); font-size:0.85rem;">User ID</p>
                                    <p id="profileUserId" style="font-family:monospace; background:#FFE0B2; padding:8px 12px; border-radius:var(--radius-sm); word-break:break-all; font-size:0.85rem;"></p>
                                </div>
                                <div>
                                    <p style="margin-bottom:6px; color:var(--gray); font-size:0.85rem;">Bergabung</p>
                                    <p id="profileJoinDate" style="font-weight:600; font-size:0.95rem;"></p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- MY ARTICLES -->
                    <div class="glass-effect" style="padding:30px; border-radius:var(--radius); border:1px solid #FFE0B2;">
                        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:25px;">
                            <h3 style="color:var(--primary); font-size:1.3rem; display:flex; align-items:center; gap:12px;">
                                <i class="fas fa-newspaper"></i> Artikel Saya
                            </h3>
                            <div style="display:flex; gap:12px;">
                                <input type="text" id="searchMyArticles" placeholder="Cari artikel saya..." style="padding:10px 15px; border:2px solid #FFE0B2; border-radius:var(--radius); width:200px; font-family:'Poppins',sans-serif; font-size:0.9rem; background:#FFF8F0;">
                                <button class="btn btn-primary" onclick="showCreateArticleModal()">
                                    <i class="fas fa-plus"></i> Buat Artikel
                                </button>
                            </div>
                        </div>
                        <div id="myArticlesList">
                            <div style="text-align:center; padding:50px 20px; color:var(--gray);">
                                <i class="fas fa-newspaper" style="font-size:3rem; margin-bottom:15px; opacity:0.3;"></i>
                                <p style="font-size:1rem; margin-bottom:15px;">Belum ada artikel</p>
                                <button class="btn btn-primary" onclick="showCreateArticleModal()">
                                    <i class="fas fa-plus"></i> Buat Artikel Pertama
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ADMIN PANEL -->
            <div id="adminPage" style="display:none;">
                <div style="background:white; border-radius:var(--radius-lg); overflow:hidden; margin-bottom:30px; box-shadow:var(--shadow-lg); border:1px solid #FFE0B2;">
                    <div style="background:var(--gradient-primary); color:white; padding:30px;">
                        <div style="display:flex; align-items:center; gap:15px;">
                            <div style="width:60px; height:60px; background:rgba(255,255,255,0.2); border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:1.8rem;">
                                <i class="fas fa-crown"></i>
                            </div>
                            <div>
                                <h1 style="font-size:2rem; margin-bottom:8px; font-weight:900;">Admin Panel</h1>
                                <p style="opacity:0.9; font-size:0.9rem;">Kelola semua konten dan pengguna</p>
                            </div>
                        </div>
                    </div>
                    <div style="padding:25px;">
                        <div style="display:flex; gap:12px; margin-bottom:25px; flex-wrap:wrap;">
                            <button class="btn btn-primary" id="adminAllArticlesBtn">
                                <i class="fas fa-list"></i> Semua Artikel
                            </button>
                            <button class="btn btn-secondary" id="adminPendingBtn">
                                <i class="fas fa-clock"></i> Menunggu (<span id="pendingCount">0</span>)
                            </button>
                            <button class="btn btn-warning" id="adminStatsBtn">
                                <i class="fas fa-chart-bar"></i> Statistik
                            </button>
                            <button class="btn btn-danger" id="adminUsersBtn">
                                <i class="fas fa-users"></i> Pengguna
                            </button>
                        </div>
                        <div id="adminContent">
                            <div style="text-align:center; padding:50px 20px; color:var(--gray);">
                                <div class="loading-spinner" style="margin:0 auto 20px;"></div>
                                <p>Memuat panel admin...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
        
        <!-- RIGHT SIDEBAR -->
        <aside class="sidebar-right">
            <!-- PropellerAds Right -->
            <div class="ad-banner vertical" style="margin-bottom:25px;">
                <span class="ad-label">IKLAN</span>
                <div class="ad-content">
                    <div data-zone="10380895"></div>
                </div>
            </div>
            
            <!-- RECOMMENDED ARTICLES -->
            <div class="glass-effect" style="padding:20px; margin-bottom:20px; border:1px solid #FFE0B2;">
                <h3 style="margin-bottom:15px; color:var(--primary); font-size:1.1rem; display:flex; align-items:center; gap:8px;">
                    <i class="fas fa-star" style="color:var(--warning);"></i> Rekomendasi
                </h3>
                <div id="recommendedArticles">
                    <div style="text-align:center; padding:25px 0; color:var(--gray);">
                        <div class="loading-spinner" style="width:25px; height:25px; margin:0 auto 12px;"></div>
                        <p style="font-size:0.85rem;">Memuat rekomendasi...</p>
                    </div>
                </div>
            </div>
            
            <!-- QUICK STATS -->
            <div class="glass-effect" style="padding:20px; margin-bottom:20px; border:1px solid #FFE0B2;">
                <h3 style="margin-bottom:15px; color:var(--primary); font-size:1.1rem; display:flex; align-items:center; gap:8px;">
                    <i class="fas fa-chart-line"></i> Statistik
                </h3>
                <div style="display:grid; gap:12px;">
                    <div class="stats-card" style="padding:12px;">
                        <div style="font-size:1.3rem; font-weight:800; color:var(--primary);" id="totalArticles">0</div>
                        <div style="font-size:0.8rem; color:var(--gray);">Total Artikel</div>
                    </div>
                    <div class="stats-card" style="padding:12px;">
                        <div style="font-size:1.3rem; font-weight:800; color:var(--success);" id="totalLikes">0</div>
                        <div style="font-size:0.8rem; color:var(--gray);">Total Likes</div>
                    </div>
                </div>
            </div>
            
            <!-- PropellerAds Horizontal di sidebar -->
            <div class="ad-banner horizontal" style="height:100px; margin-bottom:20px;">
                <span class="ad-label">IKLAN</span>
                <div class="ad-content">
                    <div data-zone="10380831"></div>
                </div>
            </div>
        </aside>
    </div>
    
    <!-- ==================== NOTIFICATION ==================== -->
    <div class="notification" id="notification">
        <div class="notification-icon" id="notificationIcon"></div>
        <span id="notificationText"></span>
    </div>
    
    <!-- ==================== SCRIPT ==================== -->
    <script>
        // ========== FIREBASE CONFIG ==========
        const firebaseConfig = {
            apiKey: "AIzaSyAP7lzXcSwmkOk88rXIx77j8s4gsfUs6k0",
            authDomain: "unews-4db42.firebaseapp.com",
            databaseURL: "https://unews-4db42-default-rtdb.firebaseio.com",
            projectId: "unews-4db42",
            storageBucket: "unews-4db42.firebasestorage.app",
            messagingSenderId: "382914552995",
            appId: "1:382914552995:web:ca6f2c0f6a250c39fc4b16",
            measurementId: "G-38CHL8F98F"
        };

        // ========== GLOBAL VARIABLES ==========
        let currentUser = null;
        let articles = [];
        let currentArticle = null;
        let comments = [];
        let userProfile = null;
        let articleEditor = null;
        let isAdmin = false;
        let hasMonetized = false;
        let lastArticleClickTime = 0;
        const ADMIN_UIDS = [
            "giv9y5uCw6XkES0QDqKu03SHdO72",
            "user_1766850109401_5fdho9608"
        ];

        // ========== INITIALIZE ==========
        async function initializeApp() {
            try {
                // Initialize Firebase
                if (!firebase.apps.length) {
                    firebase.initializeApp(firebaseConfig);
                }
                
                // Initialize Quill Editor with ALL features
                if (document.getElementById('articleEditor')) {
                    articleEditor = new Quill('#articleEditor', {
                        theme: 'snow',
                        modules: {
                            toolbar: [
                                [{ 'header': [1, 2, 3, 4, 5, 6, false] }],
                                ['bold', 'italic', 'underline', 'strike'],
                                [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                                [{ 'script': 'sub'}, { 'script': 'super' }],
                                [{ 'indent': '-1'}, { 'indent': '+1' }],
                                [{ 'direction': 'rtl' }],
                                [{ 'size': ['small', false, 'large', 'huge'] }],
                                [{ 'color': [] }, { 'background': [] }],
                                [{ 'font': [] }],
                                [{ 'align': [] }],
                                ['blockquote', 'code-block'],
                                ['link', 'image', 'video', 'formula'],
                                ['clean']
                            ]
                        }
                    });
                    
                    // Enable link with title
                    articleEditor.getModule('toolbar').addHandler('link', function(value) {
                        if (value) {
                            const url = prompt('Masukkan URL:');
                            if (url) {
                                const title = prompt('Masukkan judul link (opsional):', '');
                                const linkText = title || url;
                                const range = this.quill.getSelection();
                                this.quill.insertText(range.index, linkText, 'link', url);
                            }
                        }
                    });
                }
                
                // Setup authentication
                await setupFirebaseAuth();
                
                // Load data dari Firebase
                await loadArticlesFromFirebase();
                
                // Setup event listeners
                setupEventListeners();
                
                // Check URL untuk article
                checkUrlForArticle();
                
                // Update stats
                updateStats();
                
                // Load headline
                loadHeadline();
                
                showNotification('NexeNews siap! Selamat membaca berita viral', 'success');
                
            } catch (error) {
                console.error('Initialization error:', error);
                showNotification('Error loading application', 'error');
            }
        }

        // ========== FIREBASE AUTHENTICATION ==========
        async function setupFirebaseAuth() {
            try {
                // Check if user is already logged in
                firebase.auth().onAuthStateChanged(async (user) => {
                    if (user) {
                        currentUser = user;
                        await loadUserProfileFromFirebase(user.uid);
                    } else {
                        // Try to sign in anonymously
                        try {
                            const userCredential = await firebase.auth().signInAnonymously();
                            currentUser = userCredential.user;
                            await loadUserProfileFromFirebase(currentUser.uid);
                        } catch (error) {
                            setupLocalStorageAuth();
                        }
                    }
                });
                
            } catch (error) {
                console.error('Firebase auth error:', error);
                setupLocalStorageAuth();
            }
        }

        async function loadUserProfileFromFirebase(uid) {
            try {
                const db = firebase.database();
                const snapshot = await db.ref(`users/${uid}`).once('value');
                
                if (snapshot.exists()) {
                    userProfile = snapshot.val();
                    userProfile.uid = uid;
                    
                    // Ensure stats object exists
                    if (!userProfile.stats) {
                        userProfile.stats = { articles: 0, likes: 0, views: 0 };
                    }
                    
                    // Check admin status
                    checkAdminStatus();
                    
                    updateUserUI();
                    
                } else {
                    // Create new user profile
                    userProfile = {
                        uid: uid,
                        username: 'Pengguna_' + Math.floor(Math.random() * 10000),
                        email: '',
                        password: '',
                        joinDate: Date.now(),
                        stats: {
                            articles: 0,
                            likes: 0,
                            views: 0
                        }
                    };
                    
                    await db.ref(`users/${uid}`).set(userProfile);
                    updateUserUI();
                }
                
            } catch (error) {
                console.error('Error loading user profile from Firebase:', error);
                setupLocalStorageAuth();
            }
        }

        function setupLocalStorageAuth() {
            const storedProfile = localStorage.getItem('nexenews_userProfile');
            if (storedProfile) {
                userProfile = JSON.parse(storedProfile);
                currentUser = { uid: userProfile.uid };
                updateUserUI();
            }
        }

        async function saveUserProfile() {
            if (!currentUser || !userProfile) return;
            
            try {
                const db = firebase.database();
                await db.ref(`users/${currentUser.uid}`).set(userProfile);
                
                // Also save to localStorage for backup
                localStorage.setItem('nexenews_userProfile', JSON.stringify(userProfile));
                
                return true;
            } catch (error) {
                console.error('Error saving user profile:', error);
                return false;
            }
        }

        // ========== LOGIN SYSTEM ==========
        async function loginUser() {
            const username = document.getElementById('loginUsername').value.trim();
            const email = document.getElementById('loginEmail').value.trim();
            const password = document.getElementById('loginPassword').value;
            
            if (!username) {
                showNotification('Username harus diisi', 'error');
                return;
            }
            
            if (password && password.length < 6) {
                showNotification('Password minimal 6 karakter', 'error');
                return;
            }
            
            try {
                let user;
                
                if (password) {
                    // Try to login with email/password
                    try {
                        const userCredential = await firebase.auth().signInWithEmailAndPassword(email || username + '@nexenews.com', password);
                        user = userCredential.user;
                    } catch (signInError) {
                        // If login fails, try to create new account
                        try {
                            const userCredential = await firebase.auth().createUserWithEmailAndPassword(email || username + '@nexenews.com', password);
                            user = userCredential.user;
                        } catch (createError) {
                            showNotification('Gagal membuat akun: ' + createError.message, 'error');
                            return;
                        }
                    }
                } else {
                    // Continue as anonymous
                    const userCredential = await firebase.auth().signInAnonymously();
                    user = userCredential.user;
                }
                
                // Update user profile
                const db = firebase.database();
                const userRef = db.ref(`users/${user.uid}`);
                const snapshot = await userRef.once('value');
                
                if (snapshot.exists()) {
                    userProfile = snapshot.val();
                    userProfile.uid = user.uid;
                    
                    // Update username if changed
                    if (username !== userProfile.username) {
                        userProfile.username = username;
                        await userRef.child('username').set(username);
                    }
                    
                    if (email && email !== userProfile.email) {
                        userProfile.email = email;
                        await userRef.child('email').set(email);
                    }
                } else {
                    // Create new profile
                    userProfile = {
                        uid: user.uid,
                        username: username,
                        email: email || '',
                        joinDate: Date.now(),
                        stats: {
                            articles: 0,
                            likes: 0,
                            views: 0
                        }
                    };
                    await userRef.set(userProfile);
                }
                
                currentUser = user;
                
                document.getElementById('loginModal').classList.remove('active');
                
                updateUserUI();
                
                showNotification(`Selamat datang, ${username}!`, 'success');
                
                // Save to localStorage
                localStorage.setItem('nexenews_userProfile', JSON.stringify(userProfile));
                
                if (currentArticle) {
                    updateCommentForm();
                }
                
            } catch (error) {
                console.error('Error logging in:', error);
                showNotification('Gagal login: ' + error.message, 'error');
            }
        }

        // ========== FIREBASE ARTICLES ==========
        async function loadArticlesFromFirebase() {
            try {
                const db = firebase.database();
                const snapshot = await db.ref('articles').once('value');
                
                if (snapshot.exists()) {
                    const articlesData = snapshot.val();
                    articles = Object.entries(articlesData).map(([id, data]) => ({
                        id,
                        ...data
                    }));
                    
                    articles.forEach(article => {
                        article.score = calculateArticleScore(article);
                    });
                    
                    displayTrendingArticles();
                    displayNewestArticles();
                    displayRecommendedArticles();
                    
                } else {
                    await createSampleArticles();
                }
                
            } catch (error) {
                console.error('Error loading articles from Firebase:', error);
                loadArticlesFromLocalStorage();
            }
        }

        async function createSampleArticles() {
            const sampleArticles = [
                {
                    id: 'sample_' + Date.now(),
                    title: 'Selamat datang di NexeNews! Platform Berita Viral Indonesia',
                    category: 'fakta',
                    image: 'https://images.unsplash.com/photo-1588681664899-f142ff2dc9b1?w=1200&auto=format&fit=crop&q=80',
                    content: '<h2>Platform Berita Viral Terbaik</h2><p>NexeNews adalah platform untuk berbagi cerita, fakta unik, dan konten viral dari Indonesia. Mulai buat artikel pertamamu sekarang!</p><h3>Fitur Unggulan</h3><ul><li>Algoritma trending yang canggih</li><li>Sistem like dan komentar real-time</li><li>Editor artikel yang modern</li><li>Dashboard admin yang lengkap</li></ul>',
                    excerpt: 'Platform berita viral Indonesia dengan fitur lengkap dan modern',
                    author: 'Admin NexeNews',
                    authorId: ADMIN_UIDS[0],
                    authorAvatar: '',
                    timestamp: Date.now() - 3600000,
                    views: 250,
                    likes: 45,
                    comments: 8,
                    status: 'published',
                    score: 450
                }
            ];
            
            articles = sampleArticles;
            
            try {
                const db = firebase.database();
                for (const article of sampleArticles) {
                    await db.ref(`articles/${article.id}`).set(article);
                }
            } catch (error) {
                localStorage.setItem('nexenews_articles', JSON.stringify(articles));
            }
            
            displayTrendingArticles();
            displayNewestArticles();
            displayRecommendedArticles();
            updateStats();
        }

        // ========== CREATE ARTICLE ==========
        async function publishArticle() {
            if (!userProfile) {
                showNotification('Login dulu untuk membuat artikel', 'error');
                showLoginModal();
                return;
            }
            
            const title = document.getElementById('articleTitleInput').value.trim();
            const category = document.getElementById('articleCategoryInput').value;
            const image = document.getElementById('articleImageInput').value.trim();
            const content = articleEditor ? articleEditor.root.innerHTML : '';
            
            if (!title || title.length < 10) {
                showNotification('Judul minimal 10 karakter', 'error');
                return;
            }
            
            if (!content || content.length < 100) {
                showNotification('Konten artikel minimal 100 karakter', 'error');
                return;
            }
            
            try {
                const db = firebase.database();
                const articleId = 'article_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                
                const newArticle = {
                    id: articleId,
                    title,
                    category,
                    image: image || 'https://images.unsplash.com/photo-1588681664899-f142ff2dc9b1?w=1200&auto=format&fit=crop&q=80',
                    content,
                    excerpt: content.replace(/<[^>]*>/g, '').substring(0, 200) + '...',
                    author: userProfile.username,
                    authorId: userProfile.uid,
                    authorAvatar: '',
                    timestamp: Date.now(),
                    views: 0,
                    likes: 0,
                    comments: 0,
                    status: 'pending', // Changed from 'published' to 'pending'
                    score: 0
                };
                
                await db.ref(`articles/${articleId}`).set(newArticle);
                
                // Update user stats
                await updateUserStats('articles', 1);
                
                articles.unshift(newArticle);
                
                document.getElementById('createArticleModal').classList.remove('active');
                
                showNotification('Artikel berhasil diajukan! Menunggu approval admin.', 'success');
                
                displayNewestArticles();
                updateStats();
                
            } catch (error) {
                console.error('Error publishing article:', error);
                showNotification('Gagal mengajukan artikel: ' + error.message, 'error');
            }
        }

        // ========== HEADLINE BANNER ==========
        function loadHeadline() {
            if (articles.length === 0) return;
            
            // Get the highest scoring published article
            const publishedArticles = articles.filter(a => a.status === 'published');
            if (publishedArticles.length === 0) return;
            
            const headline = publishedArticles.reduce((prev, current) => 
                (prev.score > current.score) ? prev : current
            );
            
            if (headline) {
                document.getElementById('headlineBanner').style.display = 'block';
                document.getElementById('headlineImage').src = headline.image;
                document.getElementById('headlineTitle').textContent = headline.title;
                document.getElementById('headlineCategory').textContent = getCategoryName(headline.category);
                document.getElementById('headlineViews').textContent = formatNumber(headline.views || 0);
                document.getElementById('headlineLikes').textContent = formatNumber(headline.likes || 0);
                document.getElementById('headlineTime').textContent = timeAgo(headline.timestamp);
                
                // Add click event
                document.getElementById('headlineBanner').onclick = () => openArticle(headline.id, true);
            }
        }

        // ========== LEADERBOARD ==========
        function showLeaderboard() {
            document.getElementById('homePage').style.display = 'none';
            document.getElementById('articlePage').style.display = 'none';
            document.getElementById('profilePage').style.display = 'none';
            document.getElementById('adminPage').style.display = 'none';
            document.getElementById('leaderboardPage').style.display = 'block';
            
            displayLeaderboard();
        }

        function displayLeaderboard() {
            const container = document.getElementById('leaderboardList');
            if (!container) return;
            
            const publishedArticles = articles
                .filter(a => a.status === 'published')
                .sort((a, b) => b.score - a.score)
                .slice(0, 20);
            
            if (publishedArticles.length === 0) {
                container.innerHTML = `
                    <div style="text-align:center; padding:50px 20px; color:var(--gray);">
                        <i class="fas fa-trophy" style="font-size:3rem; margin-bottom:15px; opacity:0.3;"></i>
                        <p style="font-size:1rem;">Belum ada artikel yang trending</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = publishedArticles.map((article, index) => `
                <div class="leaderboard-item" onclick="openArticle('${article.id}', true)">
                    <div class="leaderboard-rank">
                        ${index + 1}
                    </div>
                    <div style="flex:1;">
                        <h4 style="margin-bottom:6px; font-weight:600; color:var(--dark); font-size:0.95rem;">${article.title}</h4>
                        <div style="display:flex; gap:15px; font-size:0.8rem; color:var(--gray);">
                            <span>${getCategoryName(article.category)}</span>
                            <span><i class="far fa-eye"></i> ${article.views || 0}</span>
                            <span><i class="far fa-heart"></i> ${article.likes || 0}</span>
                            <span><i class="far fa-comment"></i> ${article.comments || 0}</span>
                            <span>Skor: ${Math.round(article.score)}</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // ========== SUPPORT SYSTEM ==========
        function showSupportOptions() {
            document.getElementById('supportModal').classList.add('active');
        }

        function selectSupportOption(option) {
            // Remove active class from all options
            document.querySelectorAll('.support-option').forEach(el => {
                el.classList.remove('active');
            });
            
            // Add active class to selected option
            document.getElementById(`support${option.charAt(0).toUpperCase() + option.slice(1)}`).classList.add('active');
            
            // Show corresponding content
            document.getElementById('supportFreeContent').style.display = option === 'free' ? 'block' : 'none';
            document.getElementById('supportSaweriaContent').style.display = option === 'saweria' ? 'block' : 'none';
        }

        function supportWithAds() {
            // Random affiliate links
            const affiliateLinks = [
                'https://example.com/affiliate1',
                'https://example.com/affiliate2'
            ];
            
            const randomLink = affiliateLinks[Math.floor(Math.random() * affiliateLinks.length)];
            window.open(randomLink, '_blank');
            
            showNotification('Terima kasih sudah support dengan iklan!', 'success');
        }

        function openSaweria() {
            window.open('https://saweria.co/omedonation', '_blank');
            showNotification('Terima kasih sudah support dengan donasi!', 'success');
        }

        // ========== CATEGORY FILTER ==========
        function filterCategory(category) {
            // Filter articles by category
            const filteredArticles = articles.filter(a => a.category === category && a.status === 'published');
            
            if (filteredArticles.length === 0) {
                showNotification(`Tidak ada artikel dalam kategori ${getCategoryName(category)}`, 'info');
                return;
            }
            
            // Create temporary display
            const container = document.getElementById('trendingArticles');
            container.innerHTML = `
                <div style="grid-column:1/-1; margin-bottom:20px; display:flex; justify-content:space-between; align-items:center;">
                    <h3 style="color:var(--primary); font-size:1.2rem;">
                        <i class="fas fa-filter"></i> Kategori: ${getCategoryName(category)} (${filteredArticles.length} artikel)
                    </h3>
                    <button class="btn btn-secondary btn-sm" onclick="displayTrendingArticles()">
                        <i class="fas fa-times"></i> Clear Filter
                    </button>
                </div>
                ${filteredArticles.map(article => `
                    <div class="article-card hover-lift" onclick="openArticle('${article.id}')">
                        <img src="${article.image || 'https://images.unsplash.com/photo-1588681664899-f142ff2dc9b1?w=800&auto=format&fit=crop&q=80'}" alt="${article.title}" style="width:100%; height:200px; object-fit:cover;">
                        <div style="padding:20px;">
                            <h3 style="margin-bottom:12px; font-size:1.1rem; line-height:1.3; font-weight:700; color:var(--dark);">${article.title}</h3>
                            <div style="display:flex; justify-content:space-between; color:var(--gray); font-size:0.8rem; border-top:1px solid #FFE0B2; padding-top:12px;">
                                <span><i class="far fa-eye"></i> ${formatNumber(article.views || 0)}</span>
                                <span><i class="far fa-heart"></i> ${formatNumber(article.likes || 0)}</span>
                                <span>${timeAgo(article.timestamp)}</span>
                            </div>
                        </div>
                    </div>
                `).join('')}
            `;
        }

        // ========== ADMIN FUNCTIONS ==========
        async function showAllArticlesAdmin() {
            const container = document.getElementById('adminContent');
            if (!container) return;
            
            const allArticles = [...articles].sort((a, b) => b.timestamp - a.timestamp);
            const pendingCount = allArticles.filter(a => a.status === 'pending').length;
            document.getElementById('pendingCount').textContent = pendingCount;
            
            container.innerHTML = `
                <div style="background:white; border-radius:var(--radius); padding:20px; box-shadow:var(--shadow); border:1px solid #FFE0B2;">
                    <h3 style="margin-bottom:15px; color:var(--primary); font-size:1.2rem;">Semua Artikel (${allArticles.length})</h3>
                    <div style="overflow-x:auto;">
                        <table style="width:100%; border-collapse:collapse;">
                            <thead>
                                <tr style="background:#FFF8F0;">
                                    <th style="padding:12px; text-align:left; border-bottom:2px solid #FFE0B2; font-weight:600; font-size:0.9rem;">Judul</th>
                                    <th style="padding:12px; text-align:left; border-bottom:2px solid #FFE0B2; font-weight:600; font-size:0.9rem;">Penulis</th>
                                    <th style="padding:12px; text-align:left; border-bottom:2px solid #FFE0B2; font-weight:600; font-size:0.9rem;">Status</th>
                                    <th style="padding:12px; text-align:left; border-bottom:2px solid #FFE0B2; font-weight:600; font-size:0.9rem;">Views</th>
                                    <th style="padding:12px; text-align:left; border-bottom:2px solid #FFE0B2; font-weight:600; font-size:0.9rem;">Likes</th>
                                    <th style="padding:12px; text-align:left; border-bottom:2px solid #FFE0B2; font-weight:600; font-size:0.9rem;">Aksi</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${allArticles.map(article => `
                                    <tr style="border-bottom:1px solid #FFE0B2; transition:var(--transition);" onmouseover="this.style.backgroundColor='#FFF8F0'" onmouseout="this.style.backgroundColor='transparent'">
                                        <td style="padding:12px; vertical-align:top;">
                                            <div style="font-weight:500; margin-bottom:4px; font-size:0.9rem;">${article.title}</div>
                                            <div style="font-size:0.8rem; color:var(--gray);">${timeAgo(article.timestamp)}</div>
                                        </td>
                                        <td style="padding:12px; vertical-align:top; font-size:0.9rem;">${article.author}</td>
                                        <td style="padding:12px; vertical-align:top;">
                                            <span style="background:${article.status === 'published' ? '#4CAF50' : article.status === 'pending' ? '#FF9800' : '#F44336'}; color:white; padding:5px 12px; border-radius:15px; font-size:0.75rem; font-weight:600;">
                                                ${article.status === 'published' ? 'Published' : article.status === 'pending' ? 'Pending' : 'Rejected'}
                                            </span>
                                        </td>
                                        <td style="padding:12px; vertical-align:top; font-size:0.9rem;">${article.views || 0}</td>
                                        <td style="padding:12px; vertical-align:top; font-size:0.9rem;">${article.likes || 0}</td>
                                        <td style="padding:12px; vertical-align:top;">
                                            <div style="display:flex; gap:8px;">
                                                <button class="btn btn-sm btn-primary" onclick="openArticle('${article.id}', true)" style="padding:6px 12px; font-size:0.8rem;">
                                                    <i class="fas fa-eye"></i>
                                                </button>
                                                ${article.status === 'pending' ? `
                                                    <button class="btn btn-sm btn-success" onclick="approveArticle('${article.id}')" style="padding:6px 12px; font-size:0.8rem;">
                                                        <i class="fas fa-check"></i>
                                                    </button>
                                                    <button class="btn btn-sm btn-danger" onclick="rejectArticle('${article.id}')" style="padding:6px 12px; font-size:0.8rem;">
                                                        <i class="fas fa-times"></i>
                                                    </button>
                                                ` : ''}
                                                <button class="btn btn-sm btn-danger" onclick="deleteArticleAdmin('${article.id}')" style="padding:6px 12px; font-size:0.8rem;">
                                                    <i class="fas fa-trash"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        async function approveArticle(articleId) {
            if (!confirm('Approve artikel ini?')) return;
            
            try {
                const db = firebase.database();
                await db.ref(`articles/${articleId}/status`).set('published');
                
                const article = articles.find(a => a.id === articleId);
                if (article) {
                    article.status = 'published';
                }
                
                showAllArticlesAdmin();
                displayTrendingArticles();
                displayNewestArticles();
                displayRecommendedArticles();
                updateStats();
                loadHeadline();
                
                showNotification('Artikel berhasil diapprove', 'success');
                
            } catch (error) {
                console.error('Error approving article:', error);
                showNotification('Gagal approve artikel', 'error');
            }
        }

        async function rejectArticle(articleId) {
            if (!confirm('Reject artikel ini?')) return;
            
            try {
                const db = firebase.database();
                await db.ref(`articles/${articleId}/status`).set('rejected');
                
                const article = articles.find(a => a.id === articleId);
                if (article) {
                    article.status = 'rejected';
                }
                
                showAllArticlesAdmin();
                
                showNotification('Artikel berhasil direject', 'success');
                
            } catch (error) {
                console.error('Error rejecting article:', error);
                showNotification('Gagal reject artikel', 'error');
            }
        }

        // ========== UTILITY FUNCTIONS ==========
        function calculateArticleScore(article) {
            const now = Date.now();
            const articleAge = now - article.timestamp;
            const ageInHours = articleAge / (1000 * 60 * 60);
            
            let score = 0;
            score += (article.views || 0) * 0.6;
            score += (article.likes || 0) * 1.0;
            score += (article.comments || 0) * 1.5;
            
            // Time decay
            if (ageInHours < 24) {
                score *= 1.5;
            } else if (ageInHours < 168) {
                score *= 1.2;
            } else {
                const weeksOld = ageInHours / 168;
                score *= Math.exp(-weeksOld * 0.5);
            }
            
            return Math.max(score, 0);
        }

        function formatNumber(num) {
            if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
            if (num >= 1000) return (num / 1000).toFixed(1) + 'K';
            return num.toString();
        }

        function timeAgo(timestamp) {
            const seconds = Math.floor((Date.now() - timestamp) / 1000);
            
            let interval = Math.floor(seconds / 31536000);
            if (interval >= 1) return interval + ' tahun lalu';
            
            interval = Math.floor(seconds / 2592000);
            if (interval >= 1) return interval + ' bulan lalu';
            
            interval = Math.floor(seconds / 86400);
            if (interval >= 1) return interval + ' hari lalu';
            
            interval = Math.floor(seconds / 3600);
            if (interval >= 1) return interval + ' jam lalu';
            
            interval = Math.floor(seconds / 60);
            if (interval >= 1) return interval + ' menit lalu';
            
            return 'Baru saja';
        }

        function getCategoryName(category) {
            const categories = {
                'misteri': 'üîÆ Misteri',
                'fakta': 'üí° Fakta Unik',
                'sejarah': 'üèõÔ∏è Sejarah',
                'teknologi': 'üíª Teknologi',
                'viral': 'üî• Viral',
                'hiburan': 'üé¨ Hiburan',
                'olahraga': '‚öΩ Olahraga',
                'kesehatan': 'üíä Kesehatan',
                'bisnis': 'üíº Bisnis',
                'pendidikan': 'üéì Pendidikan',
                'politik': 'üèõÔ∏è Politik',
                'otomotif': 'üöó Otomotif',
                'kuliner': 'üçú Kuliner',
                'wisata': 'üå¥ Wisata',
                'fashion': 'üëó Fashion'
            };
            return categories[category] || 'Artikel';
        }

        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            const text = document.getElementById('notificationText');
            const icon = document.getElementById('notificationIcon');
            
            text.textContent = message;
            
            switch(type) {
                case 'error':
                    notification.style.background = 'linear-gradient(135deg, #F44336, #D32F2F)';
                    icon.innerHTML = '<i class="fas fa-exclamation-circle"></i>';
                    break;
                case 'success':
                    notification.style.background = 'linear-gradient(135deg, #4CAF50, #388E3C)';
                    icon.innerHTML = '<i class="fas fa-check-circle"></i>';
                    break;
                case 'warning':
                    notification.style.background = 'linear-gradient(135deg, #FF9800, #F57C00)';
                    icon.innerHTML = '<i class="fas fa-exclamation-triangle"></i>';
                    break;
                default:
                    notification.style.background = 'linear-gradient(135deg, #FF5722, #E64A19)';
                    icon.innerHTML = '<i class="fas fa-info-circle"></i>';
            }
            
            notification.classList.add('active');
            setTimeout(() => notification.classList.remove('active'), 4000);
        }

        // ========== SETUP EVENT LISTENERS ==========
        function setupEventListeners() {
            // Categories toggle
            document.getElementById('categoriesToggle').addEventListener('click', () => {
                document.getElementById('categoriesContent').classList.toggle('active');
            });
            
            // Login button
            document.getElementById('loginBtn').addEventListener('click', showLoginModal);
            
            // Login modal
            document.getElementById('closeLoginModal').addEventListener('click', () => {
                document.getElementById('loginModal').classList.remove('active');
            });
            
            document.getElementById('submitLoginBtn').addEventListener('click', loginUser);
            
            // Support modal
            document.getElementById('closeSupportModal').addEventListener('click', () => {
                document.getElementById('supportModal').classList.remove('active');
            });
            
            // Create article modal
            document.getElementById('closeCreateModal').addEventListener('click', () => {
                document.getElementById('createArticleModal').classList.remove('active');
            });
            
            document.getElementById('publishArticleBtn').addEventListener('click', publishArticle);
            
            // Title input for slug generation
            document.getElementById('articleTitleInput').addEventListener('input', function() {
                const slug = this.value.toLowerCase()
                    .replace(/[^\w\s]/g, '')
                    .replace(/\s+/g, '-')
                    .substring(0, 50);
                document.getElementById('articleSlugInput').value = slug;
            });
            
            // User avatar click
            document.getElementById('userAvatar').addEventListener('click', () => {
                document.getElementById('profilePopup').classList.toggle('active');
            });
            
            // Profile popup buttons
            document.getElementById('popupProfileBtn').addEventListener('click', () => {
                document.getElementById('profilePopup').classList.remove('active');
                showProfilePage();
            });
            
            document.getElementById('popupMyArticlesBtn').addEventListener('click', () => {
                document.getElementById('profilePopup').classList.remove('active');
                showProfilePage();
            });
            
            document.getElementById('popupAdminBtn').addEventListener('click', () => {
                document.getElementById('profilePopup').classList.remove('active');
                showAdminPanel();
            });
            
            // Close popups when clicking outside
            document.addEventListener('click', (e) => {
                if (!e.target.closest('#userAvatar') && !e.target.closest('.profile-popup')) {
                    document.getElementById('profilePopup').classList.remove('active');
                }
                if (e.target.classList.contains('modal')) {
                    document.getElementById('loginModal').classList.remove('active');
                    document.getElementById('supportModal').classList.remove('active');
                    document.getElementById('createArticleModal').classList.remove('active');
                }
            });
            
            // Admin buttons
            document.getElementById('adminAllArticlesBtn').addEventListener('click', showAllArticlesAdmin);
        }

        // ========== EXPORT FUNCTIONS ==========
        window.showHomePage = showHomePage;
        window.showLeaderboard = showLeaderboard;
        window.showSupportOptions = showSupportOptions;
        window.showLoginModal = showLoginModal;
        window.showCreateArticleModal = showCreateArticleModal;
        window.openArticle = openArticle;
        window.filterCategory = filterCategory;
        window.supportWithAds = supportWithAds;
        window.openSaweria = openSaweria;
        window.selectSupportOption = selectSupportOption;
        window.approveArticle = approveArticle;
        window.rejectArticle = rejectArticle;

        // ========== INITIALIZE APP ==========
        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
</body>
</html>
