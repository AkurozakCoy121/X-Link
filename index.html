<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NexeID - Ultimate Game Database</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;900&family=Inter:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        body { background-color: #050505; color: #e5e5e5; font-family: 'Inter', sans-serif; }
        .cyber-font { font-family: 'Orbitron', sans-serif; }
        .yellow-accent { color: #facc15; }
        .bg-yellow-accent { background-color: #facc15; }
        .game-card { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); border: 1px solid #27272a; }
        .game-card:hover { border-color: #facc15; transform: translateY(-8px); box-shadow: 0 10px 30px -10px rgba(250, 204, 21, 0.3); }
        .modal { transition: all 0.3s ease; backdrop-filter: blur(8px); }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-thumb { background: #facc15; border-radius: 10px; }
    </style>
</head>
<body>

    <header class="sticky top-0 z-40 bg-black/80 border-b border-yellow-500/20 px-6 py-4">
        <div class="container mx-auto flex flex-col md:flex-row justify-between items-center gap-4">
            <h1 class="text-3xl font-black yellow-accent cyber-font tracking-widest">NEXE<span class="text-white">ID</span></h1>
            
            <div class="flex flex-1 w-full max-w-2xl gap-2">
                <input type="text" id="searchInput" placeholder="Cari 500.000+ game..." 
                    class="w-full bg-zinc-900 border border-zinc-700 rounded-lg px-4 py-2 focus:outline-none focus:border-yellow-500 transition">
                <select id="platformFilter" class="bg-zinc-900 border border-zinc-700 rounded-lg px-2 text-sm focus:outline-none">
                    <option value="">Semua Platform</option>
                    <option value="4">PC</option>
                    <option value="187">PlayStation 5</option>
                    <option value="186">Xbox Series S/X</option>
                    <option value="7">Nintendo Switch</option>
                </select>
            </div>
        </div>
    </header>

    <nav class="container mx-auto px-4 mt-6">
        <div id="genreList" class="flex flex-wrap gap-2 justify-center">
            </div>
    </nav>

    <main class="container mx-auto px-4 py-10">
        <div id="gameList" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
            </div>
        <div class="flex justify-center mt-12">
            <button id="loadMore" class="bg-yellow-500 text-black font-black px-10 py-3 rounded-full hover:bg-yellow-400 transition transform hover:scale-105">LOAD MORE GAMES</button>
        </div>
    </main>

    <div id="modal" class="modal opacity-0 pointer-events-none fixed inset-0 flex items-center justify-center z-50 p-4">
        <div class="absolute inset-0 bg-black/90" onclick="toggleModal()"></div>
        <div id="modalContent" class="relative bg-zinc-950 w-full max-w-4xl max-h-[90vh] overflow-y-auto rounded-2xl border border-yellow-500/30 shadow-2xl p-6 md:p-10">
            </div>
    </div>

    <script>
        const API_KEY = '7ac2abb044514681b32c559bc713812a';
        let currentPage = 1;
        let currentSearch = '';
        let currentPlatform = '';
        let currentGenre = '';

        // Initialize
        async function init() {
            await fetchGenres();
            await fetchGames();
        }

        // 1. Fitur Genre (Kategori)
        async function fetchGenres() {
            const res = await fetch(`https://api.rawg.io/api/genres?key=${API_KEY}`);
            const data = await res.json();
            const genreList = document.getElementById('genreList');
            genreList.innerHTML += data.results.slice(0, 8).map(g => `
                <button onclick="filterGenre('${g.slug}')" class="px-4 py-1 border border-zinc-700 rounded-full text-xs hover:border-yellow-500 transition">${g.name}</button>
            `).join('');
        }

        // 2. Fitur List Game dengan Filters
        async function fetchGames(append = false) {
            if (!append) {
                currentPage = 1;
                document.getElementById('gameList').innerHTML = '<p class="col-span-full text-center yellow-accent animate-pulse">Scanning Database...</p>';
            }

            let url = `https://api.rawg.io/api/games?key=${API_KEY}&page=${currentPage}&page_size=12`;
            if (currentSearch) url += `&search=${currentSearch}`;
            if (currentPlatform) url += `&platforms=${currentPlatform}`;
            if (currentGenre) url += `&genres=${currentGenre}`;

            const res = await fetch(url);
            const data = await res.json();
            renderGames(data.results, append);
        }

        function renderGames(games, append) {
            const list = document.getElementById('gameList');
            const html = games.map(game => `
                <div class="game-card bg-zinc-900/50 rounded-xl overflow-hidden group shadow-lg">
                    <div class="relative overflow-hidden">
                        <img src="${game.background_image || 'https://via.placeholder.com/400x225'}" class="w-full h-52 object-cover group-hover:scale-110 transition duration-500">
                        <div class="absolute top-2 right-2 bg-black/70 px-2 py-1 rounded text-yellow-500 font-bold text-xs border border-yellow-500/50">
                            â˜… ${game.rating}
                        </div>
                    </div>
                    <div class="p-5">
                        <h3 class="cyber-font text-sm font-bold truncate mb-3 uppercase tracking-wider">${game.name}</h3>
                        <div class="flex flex-wrap gap-1 mb-4 h-6 overflow-hidden">
                            ${game.genres.slice(0, 2).map(g => `<span class="text-[10px] text-zinc-400">#${g.name}</span>`).join('')}
                        </div>
                        <button onclick="showDetail(${game.id})" class="w-full bg-zinc-800 hover:bg-yellow-500 hover:text-black py-2 rounded font-black text-xs transition">LIHAT DETAIL</button>
                    </div>
                </div>
            `).join('');

            if (append) list.innerHTML += html;
            else list.innerHTML = html;
        }

        // 3. Fitur Detail Lengkap (Screenshots + Stores)
        async function showDetail(id) {
            toggleModal();
            document.getElementById('modalContent').innerHTML = '<div class="text-center py-20 yellow-accent animate-spin text-4xl font-black">N</div>';

            const [gameRes, screenRes, storeRes] = await Promise.all([
                fetch(`https://api.rawg.io/api/games/${id}?key=${API_KEY}`),
                fetch(`https://api.rawg.io/api/games/${id}/screenshots?key=${API_KEY}`),
                fetch(`https://api.rawg.io/api/games/${id}/stores?key=${API_KEY}`)
            ]);

            const game = await gameRes.json();
            const screens = await screenRes.json();
            const stores = await storeRes.json();

            document.getElementById('modalContent').innerHTML = `
                <div class="grid md:grid-cols-2 gap-8">
                    <div>
                        <img src="${game.background_image}" class="w-full rounded-xl border border-yellow-500/20 mb-4">
                        <div class="grid grid-cols-3 gap-2">
                            ${screens.results.slice(0, 3).map(s => `<img src="${s.image}" class="rounded h-20 w-full object-cover border border-zinc-800">`).join('')}
                        </div>
                    </div>
                    <div>
                        <h2 class="text-4xl font-black yellow-accent cyber-font mb-2">${game.name}</h2>
                        <p class="text-zinc-500 text-sm mb-6">Released: ${game.released} | Publisher: ${game.publishers?.[0]?.name || 'N/A'}</p>
                        
                        <div class="mb-6">
                            <h4 class="text-xs font-bold text-yellow-500 uppercase mb-2 tracking-widest">Tentang Game</h4>
                            <div class="text-zinc-300 text-sm leading-relaxed max-h-40 overflow-y-auto pr-2 custom-scroll">
                                ${game.description_raw}
                            </div>
                        </div>

                        <div class="mb-6">
                            <h4 class="text-xs font-bold text-yellow-500 uppercase mb-2 tracking-widest">Tersedia di Store</h4>
                            <div class="flex flex-wrap gap-2">
                                ${stores.results.map(s => `<a href="${s.url}" target="_blank" class="bg-zinc-800 hover:bg-white hover:text-black px-3 py-2 rounded text-[10px] font-bold transition">STORE #${s.store_id}</a>`).join('')}
                            </div>
                        </div>
                    </div>
                </div>
                <button onclick="toggleModal()" class="absolute top-4 right-6 text-3xl hover:text-yellow-500">&times;</button>
            `;
        }

        // Controllers
        function toggleModal() {
            const m = document.getElementById('modal');
            m.classList.toggle('opacity-0');
            m.classList.toggle('pointer-events-none');
        }

        function filterGenre(slug) {
            currentGenre = slug;
            fetchGames();
        }

        document.getElementById('platformFilter').onchange = (e) => {
            currentPlatform = e.target.value;
            fetchGames();
        };

        document.getElementById('loadMore').onclick = () => {
            currentPage++;
            fetchGames(true);
        };

        let timer;
        document.getElementById('searchInput').oninput = (e) => {
            clearTimeout(timer);
            timer = setTimeout(() => {
                currentSearch = e.target.value;
                fetchGames();
            }, 500);
        };

        init();
    </script>
</body>
</html>
